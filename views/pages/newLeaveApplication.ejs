<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/header.css">

    <!-- importing bootstrap and other things which are used everywhere: -->
    <%- include('../partials/head'); %>

    <!-- Add your imports here -->
    <script type="text/javascript" src="js/newLeave.js"></script>

    <title>New Leave Application</title>
</head>

<header>
    <%- include('../partials/header'); %>
</header>

<body>
    <div class="MyContent">
        <div class="container-fluid">

            <div class="row">

                <div class="col card mx-2 my-4 shadow" style="padding-bottom: 10px;">

                    <div class="row w-100" style="margin-bottom: 10px;">
                        <h5 class="card-header w-100">New Leave Application
                        </h5>
                    </div>

                    <form method="POST" action="/employee/NewLeaveApplication">
                        <div class="form-group">
                            <label for="startDatePicker">From :</label>
                            <input id="startDatePicker" name="startDate" type="date" style="margin: auto 15px;">

                            <label for="endDatePicker" style="margin-left: 30px; margin-bottom: 20px;">Upto :</label>
                            <input id="endDatePicker" name="endDate" type="date" style="margin: auto 15px;">

                            <h6 style="margin-bottom: 25px;">Number of Days :
                                <span id="num_days">NaN</span>
                            </h6>

                            <textarea type="text" class="form-control mx-1 my-3" name="content" id="content"
                                placeholder="Enter comment/reason" rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                    
                    <script>
                        $(function () {
                            $("#startDatePicker").change(function(){
                                console.log("fbhdafd")

                                let leavesRemaining = <%= employee.leavesRemaining %>;
                                let dateI1 = document.getElementById("startDatePicker").value;
                                let date1 = new Date(dateI1);
                                
                                if(date1 > new Date()){
                                    console.log("h1")
                                    
                                    console.log("adate: ", date1)
                                    date1.setDate(date1.getDate() + leavesRemaining);

                                    $("#endDatePicker").attr("max", date1.toISOString().split('T')[0])
                                }else{
                                    console.log("h2")
                                    $("#endDatePicker").removeAttr("max")
                                }
                                    
                            })

                        })

                    </script>                    

                </div>

            </div>

        </div>
    </div>

</body>

</html>